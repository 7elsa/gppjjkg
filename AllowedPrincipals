(["DirectoryId", "WorkspaceSecurityGroupId", "CustomSecurityGroupId"] | @csv),
(
  .Directories[] |
  .DirectoryId as $dirId |
  .WorkspaceCreationProperties.CustomSecurityGroupId as $customSg |
  ( .WorkspaceSecurityGroupId // [] | if length == 0 then [""] else . end )[] as $wsSg |
  {
    DirectoryId: $dirId,
    WorkspaceSecurityGroupId: ($wsSg // ""),
    CustomSecurityGroupId: ($customSg // "")
  } |
  [.DirectoryId, .WorkspaceSecurityGroupId, .CustomSecurityGroupId] | @csv
)
